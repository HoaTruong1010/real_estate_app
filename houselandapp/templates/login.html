<title>{% block title %}Login{% endblock %}</title>
<link rel="icon"
    href="https://res.cloudinary.com/doaux2ndg/image/upload/v1670076213/FlightMangement/icon-web_fgxmmq.png">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">
<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<div id="notify">

</div>
{% if not err_msg['id'].__eq__(-1) %}
{% if err_msg['is_true'] %}
<div class="alert alert-success" id="success">
    {{err_msg['content']}}
</div>
{% else %}
<div class="alert alert-danger" id="failed">
    {{err_msg['content']}}
</div>
{% endif %}
{% endif %}

<div class="container" id="container">
    <div class="form-container sign-up-container">
        <form method="post" enctype="multipart/form-data">
            <h1>Tạo tài khoản</h1>
            <div id="step-1">
                <div class="infield step-1">
                    <input id="phone" type="number" required placeholder="Số điện thoại" name="r_phone" />
                    <label></label>
                </div>
                <p id="err-phone" style="color: red;"></p>
                <div class="infield step-1">
                    <input type="password" required placeholder="Mật khẩu (eg: aBcd1234)" name="r_password"
                        pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" />
                    <label></label>
                </div>
                <p id="err-pass" style="color: red;"></p>
                <div class="infield step-1">
                    <input type="password" required placeholder="Nhập lại mật khẩu" name="rr_password" />
                    <label></label>
                </div>
                <p id="err-re-pass" style="color: red;"></p>
                <div id="message">
                    <h6>Password must contain the following:</h6>
                    <p id="letter" class="invalid">A <b>lowercase</b> letter</p>
                    <p id="capital" class="invalid">A <b>capital (uppercase)</b> letter</p>
                    <p id="number" class="invalid">A <b>number</b></p>
                    <p id="length" class="invalid">Minimum <b>8 characters</b></p>
                </div>
                <button disabled type="button" name="send-otp" class="step-1">Gửi OTP</button>
            </div>
            <div id="step-2">
                <header>
                    <i class="bx bxs-check-shield"></i>
                </header>
                <h4>Xin chào, nhập mã xác thực được gửi vào số điện thoại của bạn vào ô bên dưới!</h4>
                <div class="input-otp">
                    <div class="input-field">
                        <input class="enter-otp" type="number" name="ip_1" />
                        <input class="enter-otp" type="number" name="ip_2" disabled />
                        <input class="enter-otp" type="number" name="ip_3" disabled />
                        <input class="enter-otp" type="number" name="ip_4" disabled />
                        <input class="enter-otp" type="number" name="ip_5" disabled />
                        <input class="enter-otp" type="number" name="ip_6" disabled />
                    </div>
                    <p id="err-otp" style="color: red;padding-top: 10px;"></p>
                    <div>
                        <button type="button" id="back">Quay lại</button>
                        <button type="button" disabled class="verify" name="verify">Xác minh</button>
                    </div>
                </div>
            </div>
            <div id="step-3">
                <div class="infield">
                    <input type="text" placeholder="Tên của bạn" name="r_name" />
                    <label></label>
                </div>
                <div class="infield">
                    <input type="email" placeholder="Email" name="r_email" />
                    <label></label>
                </div>
                <div class="infield">
                    <div id="div-province">
                        <select name="province" class="form-control" id="province" >
                            <option value="">Chọn khu vực</option>
                        </select>                        
                        <label></label>
                    </div>
                </div>
                <div>
                    <button type="submit" name="cancel">Hủy</button>
                    <button type="button" name="register">Gửi</button>
                </div>
            </div>
        </form>
    </div>

    <div class="form-container sign-in-container">
        <form method="post">
            <h1>Đăng nhập</h1>
            <div class="infield">
                <input required id="l_phone" type="number" placeholder="Số điện thoại" name="username" />
                <label></label>
            </div>
            <div class="infield">
                <input required type="password" placeholder="Mật khẩu" name="password" />
                <label></label>
            </div>
            <a href="{{url_for('forgot_password')}}" class="forgot">Quên mật khẩu?</a>
            
            <div class="flex">
                <button name="login">đăng nhập</button>
                <p>or</p>
                <a href="/login/google" id="login__google"><img src="https://www.gstatic.com/images/branding/productlogos/googleg/v6/36px.svg" class="eRNyse TrZEUc" alt="Google G"></a>
            </div>
            
        </form>
    </div>

    <div class="overlay-container" id="overlayCon">
        <div class="overlay">
            <div class="overlay-panel overlay-left">
                <a href="/"><img
                        src="https://res.cloudinary.com/doaux2ndg/image/upload/v1670076219/FlightMangement/logo_komha6.png"
                        alt="logo"></a>
                <p>Đăng nhập để tiếp tục!</p>
                <p>Bạn chưa có tài khoản?</p>
                <button>Đăng ký</button>
            </div>
            <div class="overlay-panel overlay-right">
                <a href="/"><img
                        src="https://res.cloudinary.com/doaux2ndg/image/upload/v1670076219/FlightMangement/logo_komha6.png"
                        alt="logo"></a>
                <p>Bạn đã có tài khoản?</p>
                <p>Vui lòng chọn đăng nhập!</p>
                <button>Đăng nhập</button>
            </div>
        </div>
        <button id="overlayBtn"></button>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="{{ url_for('static', filename='js/login.js') }}"></script>
<script>
    window.onload = () => {
        const queryString = window.location.search,
        urlParams = new URLSearchParams(queryString);
        let href = document.getElementById('login__google'), newHref = href.getAttribute('href');
        if (urlParams.has('next')) {
            newHref = newHref + "?next=" + urlParams.get('next');
            href.setAttribute('href', newHref);
        }
    }
</script>